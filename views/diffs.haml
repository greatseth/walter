- @commit.diffs.each do |d|
  - lexer = `pygmentize -N #{d.a_path}`.strip
  - d.diff.each do |line|
    .diff
      - if line.diff_overview_line?
        %pre{ :class => "overview" }
          = line.utf8
      - elsif line.diff_add_line?
        %pre{ :class => "add" }
          = line.utf8.highlight(lexer)
      - elsif line.diff_remove_line?
        %pre{ :class => "remove" }
          = line.utf8.highlight(lexer)
      - elsif line.strip.empty?
        %pre &nbsp;
      - else
        %pre
          = line.utf8.highlight(lexer)
